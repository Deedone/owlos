function _defineProperties(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}var StepperWidget=function(){"use strict";function e(e,t,i){this.parentPanel=e,this.id=t,this.size=i,this.networkStatus=NET_ONLINE,this.widgetWidht=this.size/10,this.radius=this.size/2-this.widgetWidht,this.alphaValue="80",this.widgetHolder=this.parentPanel.appendChild(document.createElement("div")),this.widgetHolder.id=t+"StepperWidget",(this.widgetHolder.stepperWidget=this).widgetHolder.className="ActuatorWidget",this.widgetHolder.style.cursor="pointer",this.sPandingTop=this.size/4,this.sPandingLeft=this.size/7,this.sWidth=this.size-2*this.sPandingLeft,this.sHeight=this.size-this.size/10-this.sPandingTop,this.userMovePosition=!1,this.atProcess=!1,this.positionChangeReciever=null,this.rCanvas=$("<canvas></canvas>").attr({width:i,height:i}).get(0),this.rContext=this.rCanvas.getContext("2d");var r=$(this.widgetHolder).children("canvas");0!==r.length?r.replaceWith(this.rCanvas):$(this.rCanvas).appendTo($(this.widgetHolder)),this.rCanvas.onmousemove=this.mousemove,this.rCanvas.stepperWidget=this}var t=e.prototype;return t.mousemove=function(e){e.stopPropagation();var t=e.currentTarget.stepperWidget;if(t.atProcess)return!(t.atProcess=!1);if(1==e.buttons&&e.offsetY>t.sPandingTop&&e.offsetY<t.sPandingTop+t.sHeight){var i=(e.offsetY-t.sPandingTop)/(t.sHeight/100);return t.userMovePosition=!0,t.refresh(t.percent,i,t.widgetText,t.text),!0}return t.userMovePosition&&null!=t.positionChangeReciever&&(t.userMovePosition=!1,t.positionChangeReciever(t.toPercent)),t.userMovePosition=!1,t.refresh(t.percent,t.toPercent,t.widgetText,t.text),!1},t.refresh=function(e,t,i,r){r=getLang(r),this.percent=Math.round(e),this.toPercent=Math.round(t),this.widgetText=i,this.text=r,this.spinnerAngle=0,this.redrawAll()},t.redrawAll=function(){var e=this;this.starttime=0,requestAnimationFrame(function(){return e.drawWidget()}),this.drawText()},t.drawText=function(){var e=0;switch(null==this.textElement&&(this.textElement=this.widgetHolder.appendChild(document.createElement("div")),this.textElement.firstTime=!0),this.networkStatus){case NET_ONLINE:this.textElement.className="ActuatorWidgetText text-white text-center";break;case NET_ERROR:this.textElement.className="ActuatorWidgetText text-danger text-center";break;case NET_RECONNECT:this.textElement.className="ActuatorWidgetText text-info text-center";break;default:this.textElement.className="ActuatorWidgetText text-secondary text-center"}switch(this.textElement.firstTime&&(this.textElement.innerHTML="WWWWWW",(e=this.textElement.getBoundingClientRect().width)<this.size&&(this.textElement.style.fontSize=this.size/2/e+"rem")),this.textElement.innerHTML=this.text,this.textElement.firstTime&&(e=this.textElement.getBoundingClientRect().width,this.textElement.style.marginLeft=this.size/2-e/2+"px",this.textElement.firstTime=!1),null==this.hintElement&&(this.hintElement=this.widgetHolder.appendChild(document.createElement("div")),this.hintElement.firstTime=!0),this.networkStatus){case NET_ONLINE:this.hintElement.className="ActuatorWidgetHint text-secondary text-center";break;case NET_ERROR:this.hintElement.className="ActuatorWidgetHint text-danger text-center";break;case NET_RECONNECT:this.hintElement.className="ActuatorWidgetHint text-info text-center";break;default:this.hintElement.className="ActuatorWidgetHint text-secondary text-center"}switch(this.hintElement.firstTime&&(this.hintElement.innerHTML="WWWWW",(e=this.hintElement.getBoundingClientRect().width)<this.size&&(this.hintElement.style.fontSize=this.size/2/e+"rem")),this.networkStatus){case NET_ONLINE:this.hintElement.innerHTML=getLang("rid_online");break;case NET_ERROR:this.hintElement.innerHTML=getLang("rid_error");break;case NET_RECONNECT:this.hintElement.innerHTML=getLang("rid_connect");break;default:this.hintElement.innerHTML=this.hintElement.innerHTML=getLang("rid_offline")}e=this.hintElement.getBoundingClientRect().width,this.hintElement.style.marginLeft=this.size/2-e/2+"px",this.hintElement.firstTime=!1},t.drawWidget=function(){var e=this;this.rContext.save(),this.rContext.clearRect(0,0,this.rCanvas.width,this.rCanvas.height),this.rContext.imageSmoothingEnabled=!1;var t=this.size-5,i=this.size-5;switch(this.rContext.beginPath(),this.rContext.rect(5,i,t,5+i),this.rContext.fillStyle=theme.danger,this.networkStatus){case NET_ONLINE:this.rContext.fillStyle=theme.success;break;case NET_ERROR:this.rContext.fillStyle=theme.danger;break;case NET_RECONNECT:this.rContext.fillStyle=theme.info+this.alphaValue;break;default:this.rContext.fillStyle=theme.secondary}this.rContext.closePath(),this.rContext.fill(),this.rContext.beginPath(),this.rContext.rect(5,5,t,i),this.rContext.fillStyle=theme.secondary+"10",this.rContext.closePath(),this.rContext.fill(),this.rContext.lineCap="",this.rContext.lineWidth=1;var r=this.sHeight/100*this.percent,s=this.sHeight/100*this.toPercent;this.rContext.beginPath(),this.rContext.rect(this.sPandingLeft,this.sPandingTop,this.sWidth,this.sHeight),this.rContext.fillStyle=theme.info+this.alphaValue,this.rContext.closePath(),this.rContext.fill(),this.rContext.beginPath(),this.rContext.rect(this.sPandingLeft,this.sPandingTop,this.sWidth,r),this.rContext.fillStyle=theme.secondary,this.rContext.closePath(),this.rContext.fill(),this.rContext.beginPath(),this.rContext.rect(this.sPandingLeft,this.sPandingTop+r,this.sWidth,2),this.rContext.fillStyle=theme.info,this.rContext.closePath(),this.rContext.fill(),this.rContext.beginPath(),this.rContext.rect(this.sPandingLeft,this.sPandingTop+s,this.sWidth,2),this.userMovePosition?this.rContext.fillStyle=theme.danger:this.rContext.fillStyle=theme.success,this.rContext.closePath(),this.rContext.fill(),this.rContext.beginPath();var o=this.size/25;this.rContext.moveTo(this.sPandingLeft,this.sPandingTop+s),this.rContext.lineTo(this.sPandingLeft-o,this.sPandingTop+s+o),this.rContext.lineTo(this.sPandingLeft-o,this.sPandingTop+s-o),this.rContext.moveTo(this.sPandingLeft+this.sWidth,this.sPandingTop+s),this.rContext.lineTo(this.sPandingLeft+this.sWidth+o,this.sPandingTop+s+o),this.rContext.lineTo(this.sPandingLeft+this.sWidth+o,this.sPandingTop+s-o),this.userMovePosition?this.rContext.fillStyle=theme.danger:this.rContext.fillStyle=theme.success,this.rContext.closePath(),this.rContext.fill();for(var n=this.sHeight/100*10,a=n;a<this.sHeight;a+=n)this.rContext.beginPath(),this.rContext.moveTo(this.sPandingLeft,this.sPandingTop+a),this.rContext.lineTo(this.sPandingLeft+5,this.sPandingTop+a),this.rContext.moveTo(this.sPandingLeft+this.sWidth,this.sPandingTop+a),this.rContext.lineTo(this.sPandingLeft+this.sWidth-5,this.sPandingTop+a),this.rContext.strokeStyle=theme.light+this.alphaValue,this.rContext.stroke(),this.rContext.closePath();if(this.rContext.beginPath(),this.rContext.rect(this.sPandingLeft,this.sPandingTop,this.sWidth,this.sHeight),this.rContext.strokeStyle=theme.light+this.alphaValue,this.rContext.stroke(),this.rContext.closePath(),this.rContext.restore(),this.rContext.save(),this.rContext.beginPath(),this.rContext.font="400 50px "+theme.fontFamily.toString(),this.rContext.textAlign="center",this.rContext.fillStyle=theme.success,this.rContext.shadowBlur=1,this.rContext.shadowColor=this.rContext.fillStyle,this.rContext.shadowOffsetX=0,this.rContext.shadowOffsetY=0,this.rContext.fillText("90%",this.size/2,this.size/2,100),this.rContext.closePath(),this.rContext.restore(),this.networkStatus==NET_RECONNECT){var d=this.rCanvas.width/2,h=this.rCanvas.height/2+this.size/22;this.spinnerAngle+=.05;this.rContext.beginPath(),this.rContext.lineWidth=this.widgetWidht/3,this.rContext.arc(d,h,this.radius-this.widgetWidht-this.size/15,this.spinnerAngle,this.spinnerAngle+Math.PI,!1),this.rContext.strokeStyle=theme.info+40,this.rContext.stroke(),this.rContext.closePath(),requestAnimationFrame(function(){return e.drawWidget()})}},_createClass(e,[{key:"_newtorkStatus",get:function(){return this.networkStatus}},{key:"_networkStatus",set:function(e){e>=NET_OFFLINE&&e<=NET_RECONNECT&&(this.networkStatus=e,this.redrawAll())}},{key:"_percent",get:function(){return this.percent},set:function(e){0<=e&&e<=100&&(this.percent=e,this.redrawAll())}}]),e}(),TableWidget=function(){"use strict";function e(e,t,i,r){this.nodePropAnchors=e,this.nodesPropsPanel=t,this.driver=i,this.size=r,this.newTable()}var t=e.prototype;return t.newTable=function(){this.nodePropAnchors;var e=this.nodesPropsPanel.appendChild(document.createElement("div"));null!=this.nodePropAnchors?e.className="driverdiv tab-pane fade":e.className="col-md-"+this.size+" driverdiv TableWidget",e.id=this.driver._nodenickname+"_"+this.driver._id,this.table=e.appendChild(document.createElement("table")),this.table.className="table table-striped table-sm",this.table.id="drivertable"+this.driver._nodenickname+"_"+this.driver._id,this.table.cellspacing="0";var t=this.table.appendChild(document.createElement("thead")).appendChild(document.createElement("tr")),i=t.appendChild(document.createElement("th"));i.className="w-2",i.innerText="#",i.scope="col",(i=t.appendChild(document.createElement("th"))).className="w-10",i.innerText=getLang("property"),i.scope="col",(i=t.appendChild(document.createElement("th"))).className="w-25",i.innerText=getLang("value"),i.scope="col",(i=t.appendChild(document.createElement("th"))).className="w-25",i.innerText=getLang("newvalue"),i.scope="col",(i=t.appendChild(document.createElement("th"))).className="w-5",i.scope="col",(i=t.appendChild(document.createElement("th"))).className="w-5",i.scope="col";var r=i.appendChild(document.createElement("a"));r.href="#top",r.innerText=getLang("top"),this.tbody=this.table.appendChild(document.createElement("tbody"));for(var s=this.tbody.propertyCount=0,o=Object.keys(this.driver);s<o.length;s++){var n=o[s];null!=this.driver[n].parentid&&this.addProperty(this.driver[n])}this.driver._new&&($("#drivertable"+this.driver._nodenickname+"_"+this.driver._id).DataTable({language:{lengthMenu:getLang("dt_display")+" _MENU_ "+getLang("dt_recordsperpage"),info:getLang("dt_showing")+" _START_ "+getLang("dt_to")+" _END_ "+getLang("dt_of")+" _TOTAL_ "+getLang("dt_entries"),search:getLang("dt_search"),paginate:{first:getLang("dt_first"),last:getLang("dt_last"),next:getLang("dt_next"),previous:getLang("dt_previous")}},pageLength:50}),$(".dataTables_length").addClass("bs-select"),$('[data-toggle="tooltip"]').tooltip())},t.addProperty=function(e){var t=config.getNodeByHost(e.parenthost);if(null!=t){this.tbody.propertyCount++;var i=this.tbody.appendChild(document.createElement("tr")),r=i.appendChild(document.createElement("th"));r.scope="row",r.innerHTML=this.tbody.propertyCount;var s=i.appendChild(document.createElement("td")).appendChild(document.createElement("a"));s.target="_blank",s.setAttribute("data-toggle","tooltip"),s.setAttribute("data-placement","top"),e.addValueListner(this.onDriverPropValueChangeGetaHref,s);var o=i.appendChild(document.createElement("td")).appendChild(document.createElement("span"));o.className="align-middle";var n=o.appendChild(document.createElement("a"));n.target="_blank",n.setAttribute("data-toggle","tooltip"),n.setAttribute("data-placement","top"),e.addValueListner(this.onDriverPropValueChangeSetaHref,n);var a=createValueEdit(i.appendChild(document.createElement("td")),e.name,e.value,e.type);e.addValueListner(this.onDriverPropValueChangeEdit,a);var d=i.appendChild(document.createElement("td")),h=i.appendChild(document.createElement("td")).appendChild(document.createElement("a"));if(h.className="badge badge-secondary",h.href="#",h.style.margin="1px 0px 1px 0px",h.style.height="25px",h.style.width="50px",h.innerText="get",h.driverProperty=e,h.onclick=this.getDriverClick,e.addNetworkStatusListner(this.onDriverPropNetworkStatusChange,h),t.addNetworkStatusListner(this.onDriverPropNetworkStatusChange,h),-1!=!e.type.indexOf("r")){var l=d.appendChild(document.createElement("a"));l.className="badge badge-secondary",l.href="#",l.style.margin="1px 0px 1px 0px",l.style.height="25px",l.style.width="50px",l.setAttribute("data-toggle","tooltip"),l.setAttribute("data-placement","top"),l.driverProperty=e,l.edit=a,l.onclick=this.setDriverClick,l.innerText="set",e.addNetworkStatusListner(this.onDriverPropNetworkStatusChange,l),t.addNetworkStatusListner(this.onDriverPropNetworkStatusChange,l)}return i}},t.driverLoaded=function(){},t.onDriverPropNetworkStatusChange=function(e,t){t.networkStatus==NET_ONLINE?e.className="badge badge-success":t.networkStatus==NET_RECONNECT?e.className="badge badge-warning":t.networkStatus==NET_OFFLINE?e.className="badge badge-secondary":t.networkStatus==NET_ERROR&&(e.className="badge badge-danger")},t.onDriverPropValueChangeGetaHref=function(e,t){e.title="Get '"+t.name+"' driver property value [RESTful API execute]",e.innerText=t.name,-1!=t.type.indexOf("s")&&(e.className="text-warning"),e.href=t.parenthost+"getdriverproperty?id="+t.parentid+"&property="+t.name},t.onDriverPropValueChangeSetaHref=function(e,t){if(e.title="Set '"+t.name+"' driver property value [RESTful API execute][return '1' if success]",e.href=t.parenthost+"setdriverproperty?id="+t.parentid+"&property="+t.name+"&value="+t.value,-1!=t.type.indexOf("b"))"1"===t.value?e.innerText="true":e.innerText="false";else{var i=t.value;if(20<i.length&&(i=i.slice(0,20)+"..."),-1!=t.type.indexOf("p")){for(var r="",s=0;s<i.length;s++)r+="*";i=r}e.innerText=i}},t.onDriverPropValueChangeEdit=function(e,t){-1!=t.type.indexOf("b")?"1"==t.value?e.selectedIndex=0:e.selectedIndex=1:e.value=t.value},t.setDriverClick=function(e){e.stopPropagation();var t=e.currentTarget,i=t.driverProperty;if(i.networkStatus!=NET_RECONNECT){var r=t.edit,s=r.value;-1!=r.proptype.indexOf("b")&&(s=0==r.selectedIndex?"1":"0"),i.setValue(s,void 0,void 0)}return!1},t.getDriverClick=function(e){e.stopPropagation();var t=e.currentTarget.driverProperty;return t.networkStatus!=NET_RECONNECT&&t.getValue(void 0,void 0),!1},e}(),TemperatureWidget=function(s){"use strict";function e(e,t,i){return s.call(this,e,t,i)||this}return _inheritsLoose(e,s),e.prototype.onWidgetHolderLoad=function(e){s.prototype.onWidgetHolderLoad.call(this,e);var t=e.currentTarget.widget;t.tempWidth=(t.width-2*t.panding)/20,t.tempHeight=t.height/15,t.tempTop=t.height/4.5-t.tempHeight/2,t.tempItem=[],t.SVGWidgetExtText=new SVGText(t.SVGViewBox,t.id+"widgetexttext",t.size/160),t.SVGWidgetExtText.color=theme.secondary;for(var i=0;i<20;i++){var r=new SVGRect(t.SVGViewBox,t.id+"tempItem"+i,t.panding+t.tempWidth*i,t.tempTop,t.tempWidth-2,t.tempHeight);r.fill=i<7?theme.info:i<14?theme.warning:theme.danger,r.opacity=0,t.tempItem.push(r)}t.tempIndexWidth=(t.width-3*t.panding)/80,t.tempIndexHeight=t.height/7,t.tempIndexTop=t.height/3.5-t.tempIndexHeight/2,t.clickableToTop(),t.proprties=t._properties,t.doOnLoad()},e.prototype.drawText=function(){var e=s.prototype;if(null!=this.SVGWidgetExtText){var t=this.widgetText;this.widgetText=" C",e.drawText.call(this,0);var i=this.SVGWidgetText.width;if(this.widgetText=t,this.SVGWidgetText.text=t+" C",0!=this.SVGWidgetText.width)switch(this.SVGWidgetExtText.text="o",this.SVGWidgetText.x=this.centreX-this.SVGWidgetText.width/2,this.SVGWidgetText.y=this.centreY+this.SVGWidgetText.height/2,this.SVGWidgetExtText.x=this.SVGWidgetText.x+this.SVGWidgetText.width-i-this.SVGWidgetExtText.width/2,this.SVGWidgetExtText.y=this.centreY+this.SVGWidgetExtText.height/5,this._networkStatus){case NET_ONLINE:this.toColor(this.SVGWidgetExtText,theme.light);break;case NET_ERROR:this.toColor(this.SVGWidgetExtText,theme.danger);break;case NET_RECONNECT:this.toColor(this.SVGWidgetExtText,theme.info);break;default:this.toColor(this.SVGWidgetExtText,theme.secondary)}else this.SVGWidgetExtText.text=""}},e.prototype.drawWidget=function(){if(s.prototype.drawWidget.call(this),null!=this.tempItem){for(var e=.2*(parseFloat(this._data)+50),t=0;t<20;t++)this.tempItem[t].opacity=.1;for(t=0;t<e;t++)this.tempItem[t].opacity=1-(1-t/20)}},e}(BaseWidget),ValueWidget=function(r){"use strict";function e(e,t,i){return r.call(this,e,t,i)||this}return _inheritsLoose(e,r),e.prototype.onWidgetHolderLoad=function(e){r.prototype.onWidgetHolderLoad.call(this,e);var t=e.currentTarget.widget;t.radius=t.size/3,t.topMargin=t.centreY+t.size/10,t._properties.textfontsize={name:"Value text size",value:1,type:"f"},t.clickableToTop(),t.properties=t._properties,t.doOnLoad()},e.prototype.drawText=function(){null!=this.SVGWidgetText&&(void 0!==this.properties.textfontsize&&(this.SVGWidgetText.size=this.properties.textfontsize.value),r.prototype.drawText.call(this),this.SVGWidgetText.color=theme.danger)},e.prototype.drawWidget=function(){r.prototype.drawWidget.call(this)},e}(BaseWidget),BaseWidgetWrapper=function(){"use strict";function e(e,t,i,r,s,o){this.configPropertiesWidget=s,this.widgetProperties=o,null==t?drivers.addDriverLoadedListner(this.onDriverLoaded,this):(this.driver=t,this.driverProperty=i,this.offlineStarter(e,t._id,i.name,r))}var t=e.prototype;return t.offlineStarter=function(e,t,i,r){this.driverId=t,this.driverPropertyName=i,dashboardUI.addDashboardModeListner(this.onDashboardModeChange,this),null!=r&&r||(this.widget=new RadialWidget(e,this.makeUniqueId(t),configProperties.widgetssize),(this.widget.driverClass=this).widget.onload=this.onWidgetLoad)},t.makeUniqueId=function(e){for(var t=1,i=e;null!=document.getElementById(i+"BaseWidget");)i=e+t,t++;return i},t.onWidgetLoad=function(e){e.widgetHolder.onclick=e.driverClass.widgetClick,null!=e.driverClass.widgetProperties&&(e.properties=e.driverClass.widgetProperties),null!=e.driverClass.driver&&e.driverClass.joinDriver(e.driverClass.driver,e.driverClass.driverProperty),null!=e.driverClass._onload&&e.driverClass._onload(e.driverClass)},t.getWidgetProperties=function(){if(null!=this.widget)return this.widget.properties},t.joinDriver=function(e,t){this.driver=e,this.driverProperty=t,null!=this.widget&&null!=this.widget.driverClass&&(this.widget.driverClass.driverProperty=t),this.node=config.getNodeByHost(e._host),this.node.addNetworkStatusListner(this.onNetworkStatusChange,this),this.driverProperty.addNetworkStatusListner(this.onNetworkStatusChange,this),this.driverProperty.addValueListner(this.onValueChange,this)},t.onDriverLoaded=function(e,t){null==e.driver&&e.driverId==t._id&&e.joinDriver(t,t[e.driverPropertyName])},t.onValueChange=function(e){e.draw()},t.onNetworkStatusChange=function(e,t){null!=e.widget&&(e.widget.networkStatus=t.networkStatus)},t.onDashboardModeChange=function(e,t){null!=e.widget&&(e.widget.mode=t?WORK_MODE:MOVE_MODE)},t.widgetClick=function(e){e.stopPropagation();var t=e.currentTarget.widget;return t.mode==WORK_MODE&&t.driverClass.driverProperty.getValue(),!0},t.refresh=function(){},t.draw=function(){},_createClass(e,[{key:"onload",get:function(){return this._onload},set:function(e){this._onload=e}}]),e}(),RadialWidgetWrapper=function(n){"use strict";_inheritsLoose(t,n);var e=t.prototype;function t(e,t,i,r,s){var o;return o=n.call(this,e,t,i,!0,r,s)||this,null==t?_assertThisInitialized(o):o}return e.offlineStarter=function(e,t,i){n.prototype.offlineStarter.call(this,e,t,i,!0),this.widget=new RadialWidget(e,this.makeUniqueId(t),configProperties.widgetssize),(this.widget.driverClass=this).widget.onload=this.onWidgetLoad},e.draw=function(){if(null!=this.widget&&null!=this.driverProperty)return this.driverProperty.networkStatus==NET_ONLINE?this.widget.refresh(this.driverProperty.value,this.driverProperty.value,this.driver._id):this.widget.refresh(0,"--",this.driver._id),this.widget.networkStatus=this.driverProperty.networkStatus,!0},t}(BaseWidgetWrapper),TemperatureWidgetWrapper=function(n){"use strict";_inheritsLoose(t,n);var e=t.prototype;function t(e,t,i,r,s){var o;return o=n.call(this,e,t,i,!0,r,s)||this,null==t?_assertThisInitialized(o):o}return e.offlineStarter=function(e,t,i){n.prototype.offlineStarter.call(this,e,t,i,!0),this.widget=new TemperatureWidget(e,this.makeUniqueId(t),configProperties.widgetssize),(this.widget.driverClass=this).widget.onload=this.onWidgetLoad},e.draw=function(){if(null!=this.widget&&null!=this.driverProperty)return this.driverProperty.networkStatus==NET_ONLINE?this.widget.refresh(this.driverProperty.value,Math.round(this.driverProperty.value),this.driver._id+"-"+getLang("temperature"),this.driver.temperaturehistorydata.value):this.widget.refresh(0,"--",this.driver._id),this.widget.networkStatus=this.driverProperty.networkStatus,!0},t}(BaseWidgetWrapper),ValueWidgetWrapper=function(n){"use strict";_inheritsLoose(t,n);var e=t.prototype;function t(e,t,i,r,s){var o;return o=n.call(this,e,t,i,!0,r,s)||this,null==t?_assertThisInitialized(o):o}return e.offlineStarter=function(e,t,i){n.prototype.offlineStarter.call(this,e,t,i,!0),this.widget=new ValueWidget(e,this.makeUniqueId(t),configProperties.widgetssize),(this.widget.driverClass=this).widget.onload=this.onWidgetLoad},e.draw=function(){if(null!=this.widget&&null!=this.driverProperty)return this.driverProperty.networkStatus==NET_ONLINE?this.widget.refresh(this.driverProperty.value,this.driverProperty.value,this.driver._id+"-"+getLang("value")):this.widget.refresh(0,"--",this.driver._id),this.widget.networkStatus=this.driverProperty.networkStatus,!0},t}(BaseWidgetWrapper),HumidityWidgetWrapper=function(n){"use strict";function e(e,t,i,r,s){var o;return o=n.call(this,e,t,i,!0,r,s)||this,null==t?_assertThisInitialized(o):o}_inheritsLoose(e,n);var t=e.prototype;return t.offlineStarter=function(e,t,i){n.prototype.offlineStarter.call(this,e,t,i,!0),this.widget=new RadialWidget(e,this.makeUniqueId(t),configProperties.widgetssize),(this.widget.driverClass=this).widget.onload=this.onWidgetLoad},t.draw=function(){if(null!=this.widget&&null!=this.driverProperty)return this.driverProperty.networkStatus==NET_ONLINE?this.widget.refresh(this.driverProperty.value,Math.round(this.driverProperty.value)+"%",this.driver._id+"-"+getLang("humidity"),this.driver.humidityhistorydata.value):this.widget.refresh(0,"--",this.driver._id),this.widget.networkStatus=this.driverProperty.networkStatus,!0},e}(BaseWidgetWrapper),HistoryDataGraphWidgetWrapper=function(n){"use strict";function e(e,t,i,r,s){var o;return o=n.call(this,e,t,i,!0,r,s)||this,null==t?_assertThisInitialized(o):o}_inheritsLoose(e,n);var t=e.prototype;return t.offlineStarter=function(e,t,i){n.prototype.offlineStarter.call(this,e,t,i,!0),this.widget=new GraphWidget(e,this.makeUniqueId(t),configProperties.widgetssize,temperatureIcon),(this.widget.driverClass=this).widget.onload=this.onWidgetLoad},t.onWidgetLoad=function(e){e.widgetHolder.onclick=e.driverClass.widgetClick,null!=e.driverClass.widgetProperties&&(e.properties=e.driverClass.widgetProperties),null!=e.driverClass.driver&&e.driverClass.joinDriver(e.driverClass.driver,e.driverClass.driverProperty),null!=e.driverClass._onload&&e.driverClass._onload(e.driverClass)},t.draw=function(){if(null!=this.widget&&null!=this.driverProperty)return this.driverProperty.networkStatus==NET_ONLINE?this.widget.refresh(this.driverProperty.value,this.driver._id,this.driverProperty.value):this.widget.refresh(0,"--",this.driver._id),this.widget.networkStatus=this.driverProperty.networkStatus,!0},e}(BaseWidgetWrapper),LightWidgetWrapper=function(n){"use strict";_inheritsLoose(t,n);var e=t.prototype;function t(e,t,i,r,s){var o;return o=n.call(this,e,t,i,!0,r,s)||this,null==t?_assertThisInitialized(o):o}return e.offlineStarter=function(e,t,i){n.prototype.offlineStarter.call(this,e,t,i,!0),this.widget=new LightWidget(e,this.makeUniqueId(t),configProperties.widgetssize),(this.widget.driverClass=this).widget.onload=this.onWidgetLoad},e.draw=function(){if(null!=this.widget&&null!=this.driverProperty){if(this.driverProperty.networkStatus==NET_ONLINE){var e=Math.round(this.driverProperty.value/10.24);e<35?this.widget.refresh(e,getLang("low"),this.driver._id,this.driver.historydata.value):e<70?this.widget.refresh(e,getLang("norm"),this.driver._id,this.driver.historydata.value):this.widget.refresh(e,getLang("high"),this.driver._id,this.driver.historydata.value)}else this.widget.refresh(0,"--",this.driver._id);return this.widget.networkStatus=this.driverProperty.networkStatus,!0}},t}(BaseWidgetWrapper),SmokeWidgetWrapper=function(n){"use strict";_inheritsLoose(t,n);var e=t.prototype;function t(e,t,i,r,s){var o;return o=n.call(this,e,t,i,!0,r,s)||this,null==t?_assertThisInitialized(o):o}return e.offlineStarter=function(e,t,i){n.prototype.offlineStarter.call(this,e,t,i,!0),this.widget=new SmokeWidget(e,this.makeUniqueId(t),configProperties.widgetssize),(this.widget.driverClass=this).widget.onload=this.onWidgetLoad},e.draw=function(){if(null!=this.widget&&null!=this.driverProperty){if(this.driverProperty.networkStatus==NET_ONLINE){var e=Math.round(this.driverProperty.value/10.24);this.driverProperty.value<50?this.widget.refresh(e,getLang("smokelow"),this.driver._id,this.driver.historydata.value):this.driverProperty.value<configProperties.widgetssize?this.widget.refresh(e,getLang("smokenorm"),this.driver._id,this.driver.historydata.value):this.widget.refresh(e,getLang("smokehigh"),this.driver._id,this.driver.historydata.value)}else this.widget.refresh(0,"--",this.driver._id);return this.widget.networkStatus=this.driverProperty.networkStatus,!0}},t}(BaseWidgetWrapper),MotionWidgetWrapper=function(n){"use strict";_inheritsLoose(t,n);var e=t.prototype;function t(e,t,i,r,s){var o;return o=n.call(this,e,t,i,!0,r,s)||this,null==t?_assertThisInitialized(o):o}return e.offlineStarter=function(e,t,i){n.prototype.offlineStarter.call(this,e,t,i,!0),this.widget=new MotionWidget(e,this.makeUniqueId(t),configProperties.widgetssize),(this.widget.driverClass=this).widget.onload=this.onWidgetLoad},e.draw=function(){if(null!=this.widget&&null!=this.driverProperty){if(this.driverProperty.networkStatus==NET_ONLINE){var e=this.driverProperty.value;if(null!=this.driver.historydata.value){var t=this.driver.historydata.value.split(";"),i=parseInt(t[0]),r=0;if(6<i)for(var s=i-6;s<i+1;s++)r+=parseFloat(t[s]);else for(s=1;s<i+1;s++)r+=parseFloat(t[s]);0!=r&&(e=1)}var o="notdetect";1==e&&(o="detect"),this.widget.refresh(e,o,this.driver._id,this.driver.historydata.value)}else this.widget.refresh(0,"--",this.driver._id);return this.widget.networkStatus=this.driverProperty.networkStatus,!0}},t}(BaseWidgetWrapper),SensorWidgetWrapper=function(e){"use strict";function t(){return e.apply(this,arguments)||this}return _inheritsLoose(t,e),t.prototype.draw=function(){if(null!=this.widget&&null!=this.driverProperty){if(this.driverProperty.networkStatus==NET_ONLINE){var e=0,t=getLang("non");1==this.driverProperty.value&&(e=100,t=getLang("yes")),this.widget.refresh(e,t,this.driver._id)}else this.widget.refresh(0,"--",this.driver._id);return this.widget.networkStatus=this.driverProperty.networkStatus,!0}},t}(BaseWidgetWrapper),ActuatorWidgetWrapper=function(){"use strict";function e(e,t,i,r,s){this.configPropertiesWidget=r,this.widgetProperties=s,null==t?drivers.addDriverLoadedListner(this.onDriverLoaded,this):(this.driver=t,this.driverProperty=i,this.offlineStarter(e,t._id,i.name,!1))}var t=e.prototype;return t.offlineStarter=function(e,t,i,r){this.driverId=t,this.driverPropertyName=i,dashboardUI.addDashboardModeListner(this.onDashboardModeChange,this),null!=r&&r||(this.widget=new ActuatorWidget(e,this.makeUniqueId(t),configProperties.widgetssize),(this.widget.driverClass=this).widget.onload=this.onWidgetLoad)},t.makeUniqueId=function(e){for(var t=1,i=e;null!=document.getElementById(i+"BaseWidget");)i=e+t,t++;return i},t.onWidgetLoad=function(e){e.widgetHolder.onclick=e.driverClass.widgetClick,null!=e.driverClass.widgetProperties&&(e.properties=e.driverClass.widgetProperties),null!=e.driverClass.driver&&e.driverClass.joinDriver(e.driverClass.driver,e.driverClass.driverProperty),null!=e.driverClass._onload&&e.driverClass._onload(e.driverClass)},t.joinDriver=function(e,t){this.driver=e,this.driverProperty=t,null!=this.widget&&(this.widget.driverClass.driverProperty=t),this.node=config.getNodeByHost(e._host),this.node.addNetworkStatusListner(this.onNetworkStatusChange,this),this.driverProperty.addNetworkStatusListner(this.onNetworkStatusChange,this),this.driverProperty.addValueListner(this.onValueChange,this)},t.onDriverLoaded=function(e,t){null==e.driver&&e.driverId==t._id&&e.joinDriver(t,t[e.driverPropertyName])},t.onValueChange=function(e){e.draw()},t.onNetworkStatusChange=function(e,t){null!=e.widget&&(e.widget.networkStatus=t.networkStatus)},t.onDashboardModeChange=function(e,t){null!=e.widget&&(e.widget.mode=t?WORK_MODE:MOVE_MODE)},t.widgetClick=function(e){e.stopPropagation();var t=e.currentTarget.widget;if(t.mode==WORK_MODE){var i=t.driverClass.driverProperty;1==parseInt(i.value)?i.setValue(0):i.setValue(1)}return!0},t.draw=function(){if(null!=this.widget&&null!=this.driverProperty){if(this.driverProperty.networkStatus==NET_ONLINE){var e="off";1==parseInt(this.driverProperty.value)&&(e="on"),this.widget.refresh(this.driverProperty.value,e,this.driver._id)}else this.widget.refresh(0,"--",this.driver._id);return this.widget.networkStatus=this.driverProperty.networkStatus,!0}},_createClass(e,[{key:"onload",get:function(){return this._onload},set:function(e){this._onload=e}}]),e}(),LCDWidgetWrapper=function(){"use strict";function e(e,t,i,r,s,o){this.configPropertiesWidget=s,null==t?drivers.addDriverLoadedListner(this.onDriverLoaded,this):(this.offlineStarter(e,t._id,i.name,r),this.joinDriver(t,i))}var t=e.prototype;return t.offlineStarter=function(e,t,i,r){this.driverId=t,this.driverPropertyName=i,dashboardUI.addDashboardModeListner(this.onDashboardModeChange,this),null!=r&&r||(this.widget=new LCDWidget(e,this.makeUniqueId(t),configProperties.widgetssize),(this.widget.driverClass=this).widget.onload=this.onWidgetLoad)},t.makeUniqueId=function(e){for(var t=1,i=e;null!=document.getElementById(i+"BaseWidget");)i=e+t,t++;return i},t.onWidgetLoad=function(){this.widget.lcdButton.onclick=this.lcdTextClick,this.widget.lightButton.onclick=this.lcdLightClick,this.draw()},t.joinDriver=function(e,t){this.driver=e,this.driver.text.addNetworkStatusListner(this.onTextChange,this),this.driver.text.addValueListner(this.onTextChange,this),this.driver.backlight.addValueListner(this.onLightChange,this),this.driverProperty=t,this.widget.driverClass.driverProperty=t,this.node=config.getNodeByHost(e._host),this.node.addNetworkStatusListner(this.onNetworkStatusChange,this),this.driverProperty.addNetworkStatusListner(this.onNetworkStatusChange,this),this.driverProperty.addValueListner(this.onValueChange,this)},t.onDriverLoaded=function(e,t){null==e.driver&&e.driverId==t._id&&e.joinDriver(t,t[e.driverPropertyName])},t.onDashboardModeChange=function(e,t){null!=e.widget&&(e.widget.mode=t?WORK_MODE:MOVE_MODE)},t.onNetworkStatusChange=function(e,t){null!=e.widget&&(e.widget.networkStatus=t.networkStatus)},t.onTextChange=function(e){e.draw()},t.onLightChange=function(e){e.draw()},t.lcdTextClick=function(e){e.stopPropagation();var t=e.currentTarget.widget;t.mode==WORK_MODE&&(t.hideEditor(),t.driverClass.driver.text.setValue(t.textarea.value))},t.lcdLightClick=function(e){e.stopPropagation();var t=e.currentTarget.widget;if(t.mode==WORK_MODE){t.hideEditor();var i=t.driverClass.driver.backlight;1==parseInt(i.value)?i.setValue(0):i.setValue(1)}},t.draw=function(){if(null!=this.widget&&null!=this.driver)return this.driver.text.networkStatus==NET_ONLINE?null!=this.driver.text.value?this.widget.refresh(this.driver.text.value,this.driver._id,this.driver.backlight.value):this.widget.refresh("",this.driver._id,this.driver.backlight.value):this.widget.refresh("",this.driver._id,0),this.widget.networkStatus=this.driver.text.networkStatus,!0},e}(),StepperWidgetWrapper=function(){"use strict";function e(e,t,i){this.id=t,this.propertyName=i,this.stepperWidget=new StepperWidget(e,t,configProperties.widgetssize),(this.stepperWidget.driverClass=this).stepperWidget.positionChangeReciever=this.positionChange}var t=e.prototype;return t.positionChange=function(e){if(this.atProcess)this.atProcess=!1;else{this.atProcess=!0;var t=this.driverClass,i=e*(t.range/100);setDriverPropertyAsyncWithReciever(t.id,"toposition",i,t.clientCallback,t)}},t.clientCallback=function(e,t){0==!e.indexOf("%error")?t.stepperWidget.networkStatus=NET_RECONNECT:-1!=!e.indexOf("response")||t.draw(e)},t.refresh=function(){status_online==NET_ONLINE?(this.position=getParsedDriverProperty(this.id,"position"),this.toposition=getParsedDriverProperty(this.id,"toposition"),this.range=getParsedDriverProperty(this.id,"range"),this.draw(this.position,this.toposition,this.range)):this.stepperWidget.networkStatus=status_online},t.draw=function(e,t,i){if(null!=this.driverProperty&&!isNaN(e)){var r=e/(i/100),s=t/(i/100);this.stepperWidget.refresh(r,s,Math.round(r)+"%",this.id),this.stepperWidget.networkStatus=NET_ONLINE}},_createClass(e,[{key:"_networkStatus",set:function(e){this.stepperWidget.networkStatus=e}}]),e}(),WidgetsLayer={RadialWidget:{id:"radialwidget",name:getLang("radial"),widget:RadialWidgetWrapper,driversTypes:"any",driversProperties:"any"},TemperatureWidget:{id:"temperature",name:getLang("temperature"),widget:TemperatureWidgetWrapper,driversTypes:";"+DHTDriverType+";",driversProperties:";temperature;"},HumidityWidget:{id:"humidity",name:getLang("humidity"),widget:HumidityWidgetWrapper,driversTypes:";"+DHTDriverType+";",driversProperties:";humidity;"},HistoryDataGraphWidget:{id:"historydatagraph",name:getLang("historydatagraph"),widget:HistoryDataGraphWidgetWrapper,driversTypes:"any",driversProperties:";historydata;historyfile;temperaturehistorydata;humidityhistorydata;"},LightWidget:{id:"light",name:getLang("light"),widget:LightWidgetWrapper,driversTypes:";"+LightDriverType+";",driversProperties:";light;"},SmokeWidget:{id:"smoke",name:getLang("smoke"),widget:SmokeWidgetWrapper,driversTypes:";"+SmokeDriverType+";",driversProperties:";smoke;"},MotionWidget:{id:"motion",name:getLang("motion"),widget:MotionWidgetWrapper,driversTypes:";"+MotionDriverType+";",driversProperties:";motion;"},SensorWidget:{id:"sensor",name:getLang("sensor"),widget:SensorWidgetWrapper,driversTypes:";"+SensorDriverType+";",driversProperties:";data;"},LCDWidget:{id:"lcd",name:getLang("lcd"),widget:LCDWidgetWrapper,driversTypes:";"+LCDDriverType+";",driversProperties:"any"},ActuatorWidget:{id:"actuator",name:getLang("actuator"),widget:ActuatorWidgetWrapper,driversTypes:";"+ActuatorDriverType+";",driversProperties:";data;"},ValueWidget:{id:"value",name:getLang("value"),widget:ValueWidgetWrapper,driversTypes:"any",driversProperties:"any"},getWidgetById:function(e){if(null!=e)for(var t in WidgetsLayer)if(null!=WidgetsLayer[t].id&&WidgetsLayer[t].id==e)return WidgetsLayer[t]}},DEFAULT_MASK=0,ICONS_MASK=1,ActuatorWidget=function(n){"use strict";function e(e,t,i,r,s){var o=n.call(this,e,t,i)||this;return o.iconOn=r,o.iconOff=s,o}return _inheritsLoose(e,n),e.prototype.onWidgetHolderLoad=function(e){n.prototype.onWidgetHolderLoad.call(this,e);var t=e.currentTarget.widget;null==t.iconOn&&null==t.iconOff?(t.widgetType=DEFAULT_MASK,t.SVGArcBack=new SVGArc(t.SVGViewBox,t.id+"arcback",t.centreX,t.centreY+t.topMargin,t.radius+t.size/20,t.size/100),t.SVGArcBack.color=theme.secondary,t.SVGArcWidget=new SVGArc(t.SVGViewBox,t.id+"arcwidget",t.centreX,t.centreY+t.topMargin,t.radius,t.size/14),t.SVGArcWidget.color=theme.secondary,t.SVGArcWidget.fill=theme.secondary):(t.widgetType=ICONS_MASK,t.rowSize=t.size/2.5,t.SVGIconOn=new SVGIcon(t.SVGViewBox,t.iconOn,t.width/2-t.rowSize/2,t.height/2-t.rowSize/2,t.rowSize,t.rowSize),t.SVGIconOn.fill=theme.success,t.SVGIconOn.SVGIcon.widget=_assertThisInitialized(t),t.SVGIconOn.hide(),t.SVGIconOff=new SVGIcon(t.SVGViewBox,t.iconOff,t.width/2-t.rowSize/2,t.height/2-t.rowSize/2,t.rowSize,t.rowSize),t.SVGIconOff.fill=theme.success,t.SVGIconOff.SVGIcon.widget=_assertThisInitialized(t),t.SVGIconOff.hide(),t.SVGArcSpinner.y=t.centreY),t.SVGWidgetText.hide(),t.ShowEqualizer=!1,t.clickableToTop(),t.proprties=t._properties,t.doOnLoad()},e.prototype.drawWidget=function(){if(n.prototype.drawWidget.call(this),null!=this.SVGArcBack)if(this.widgetType==DEFAULT_MASK)switch(this.SVGArcBack.draw(0,359.99),0!=this.data?this.SVGArcWidget.draw(0,359.99):this.SVGArcWidget.hide(),this._networkStatus){case NET_ONLINE:this.toColor(this.SVGArcBack,theme.success),this.toColor(this.SVGArcWidget,theme.success,!1);break;case NET_ERROR:this.toColor(this.SVGArcBack,theme.danger),this.toColor(this.SVGArcWidget,theme.danger,!1);break;case NET_RECONNECT:this.toColor(this.SVGArcBack,theme.info),this.toColor(this.SVGArcWidget,theme.info,!1);break;default:this.toColor(this.SVGArcBack,theme.secondary),this.toColor(this.SVGArcWidget,theme.secondary,!1)}else switch(0!=this.data?(this.SVGIconOn.draw(),this.SVGIconOff.hide()):(this.SVGIconOn.hide(),this.SVGIconOff.draw()),this._networkStatus){case NET_ONLINE:this.SVGIconOn.fill=theme.success,this.SVGIconOff.fill=theme.success;break;case NET_ERROR:this.SVGIconOn.fill=theme.danger,this.SVGIconOff.fill=theme.danger;break;case NET_RECONNECT:this.SVGIconOn.fill=theme.info,this.SVGIconOff.fill=theme.info;break;default:this.SVGIconOn.fill=theme.secondary,this.SVGIconOff.fill=theme.secondary}},e}(BaseWidget),WORK_MODE=0,MOVE_MODE=1,EVENT_NO=0,EVENT_DELETE=1,BaseWidget=function(){"use strict";function e(e,t){this.parentPanel=e,this.id=t,this._networkStatus=NET_OFFLINE,this._event=EVENT_NO,this.mouseEnter=!1,this.widgetHolder=this.parentPanel.appendChild(document.createElement("div")),this.widgetHolder.id=t+"BaseWidget",(this.widgetHolder.widget=this).widgetHolder.className="col-3 col-sm-2 col-lg-1",this.widgetHolder.style.cursor="pointer",this.widgetHolder.onmouseover=this.mouseOver,this.widgetHolder.onmouseout=this.mouseOut,this.widgetHolder.style.display="block",waitForElement(this.widgetHolder,this.onWidgetHolderLoad);var i=document.getElementsByTagName("BODY")[0];null==i.onresize&&(i.onresize=this.onPanelResize),null==i.widgets&&(i.widgets=[]),i.widgets.push(this)}return e.prototype.onWidgetHolderLoad=function(e){var t=e.currentTarget.widget;t.size=t.widgetHolder.clientWidth,t.panding=t.size/25,t.halfPanding=t.panding/2,t.radius=t.size/7,t.width=t.size-t.halfPanding,t.height=t.size-t.halfPanding,t.topMargin=t.height/20,t.centreX=t.width/2+t.panding/2,t.centreY=t.height/2,t.SVGViewBox=document.createElementNS(xmlns,"svg"),t.SVGViewBox.setAttributeNS(null,"viewBox","0 0 "+t.size+" "+t.size),t.SVGViewBox.style.display="block",t.SVGBackgroundPanel=new SVGArc(t.SVGViewBox,t.id+"backgroundpanel",0,0,t.width,1),t.SVGBackgroundPanel.drawRoundedRect(t.width,t.height,5,10,!0,!0,!0,!0),t.SVGHeaderPanel=new SVGArc(t.SVGViewBox,t.id+"headerpanel",0,0,t.width,1),t.SVGHeaderPanel.drawRoundedRect(t.width,25,5,0,!0,!0,!1,!1),t.SVGBackdownpanel=new SVGArc(t.SVGViewBox,t.id+"backdownpanel",0,t.height-10,t.width,1),t.SVGBackdownpanel.drawRoundedRect(t.width,10,5,0,!1,!1,!0,!0),t.SVGBackdownpanel.opacity=.9,t.SVGBackdownpanel.fill=theme.secondary,t.SVGWidgetText=new SVGText(t.SVGViewBox,t.id+"widgettext",t.size/80),t.SVGWidgetText.opacity=.7,t.SVGWidgetText.color=theme.secondary,t.SVGHeaderText=new SVGText(t.SVGViewBox,t.id+"headertext",t.size/150),t.SVGHeaderText.color=theme.secondary,t.SVGHint=new SVGText(t.SVGViewBox,t.id+"hint",t.size/150),t.SVGHint.color=theme.secondary;var i=document.createElementNS(xmlns,"stop");i.setAttribute("stop-color",theme.info),i.setAttribute("stop-opacity","0.7"),i.setAttribute("offset","0%");var r=document.createElementNS(xmlns,"stop");r.setAttribute("class","stop2"),r.setAttribute("stop-color",theme.info),r.setAttribute("stop-opacity","0.4"),r.setAttribute("offset","20%");var s=document.createElementNS(xmlns,"stop");s.setAttribute("class","stop3"),s.setAttribute("stop-color",theme.info),s.setAttribute("stop-opacity","0.0"),s.setAttribute("offset","60%");var o=document.createElementNS(xmlns,"linearGradient");o.id=t.id+"widgetspinnergradient",o.appendChild(i),o.appendChild(r),o.appendChild(s),t.SVGViewBox.appendChild(o),t.SVGArcSpinner=new SVGArc(t.SVGViewBox,t.id+"arcwidget",t.centreX,t.centreY+t.topMargin,t.size/4,t.size/24),t.SVGArcSpinner.color="url(#"+t.id+"widgetspinnergradient)",t.SVGArcSpinner.opacity=.4,t.eCount=30,t.eWidth=t.size/(t.eCount+50),t.eRWidth=t.width/40,t.eHeight=t.eWidth,t.eX=t.width/2-2*t.eWidth*t.eCount/2+t.halfPanding/2+2,t.eY=t.height-2*t.eHeight*5-2,t.equalizerX=[];for(var n=0;n<t.eCount;n++){for(var a=[],d=0;d<5;d++){var h=new SVGRect(t.SVGViewBox,t.id+"equalizerpanel"+parseInt(n)+"_"+parseInt(d),t.eX+n*t.eWidth*2,t.eY+d*t.eHeight*2,t.eRWidth,t.eRWidth);h.opacity=0,h.fill=theme.secondary,a.push(h)}t.equalizerX.push(a)}t.rowSize=t.size/6,t.SVGLeftIcon=new SVGIcon(t.SVGViewBox,leftIcon,t.panding,t.height-t.rowSize,t.rowSize,t.rowSize),t.SVGLeftIcon.fill=theme.light,(t.SVGLeftIcon.SVGIcon.widget=t).SVGLeftIcon.SVGIcon.onclick=t.moveLeft,t.SVGLeftIcon.hide(),t.SVGRightIcon=new SVGIcon(t.SVGViewBox,rightIcon,t.width-t.rowSize,t.height-t.rowSize,t.rowSize,t.rowSize),t.SVGRightIcon.fill=theme.light,(t.SVGRightIcon.SVGIcon.widget=t).SVGRightIcon.SVGIcon.onclick=t.moveRight,t.SVGRightIcon.hide(),t.SVGDeleteIcon=new SVGIcon(t.SVGViewBox,deleteIcon,t.width-t.rowSize+t.size/28,0,t.rowSize,t.rowSize),t.SVGDeleteIcon.fill=theme.light,(t.SVGDeleteIcon.SVGIcon.widget=t).SVGDeleteIcon.SVGIcon.onclick=t.deleteWidgetClick,t.SVGDeleteIcon.hide(),t.SVGPropertiesIcon=new SVGIcon(t.SVGViewBox,buildIcon,t.width/2-t.rowSize/2,t.height-t.rowSize,t.rowSize,t.rowSize),t.SVGPropertiesIcon.fill=theme.light,(t.SVGPropertiesIcon.SVGIcon.widget=t).SVGPropertiesIcon.SVGIcon.onclick=t.propertiesClick,t.SVGPropertiesIcon.hide(),t.widgetHolder.appendChild(t.SVGViewBox),t._properties=t.defaultWidgetProperties(),t.resize(t.widgetHolder.clientWidth),t.mode=WORK_MODE},e.prototype.drawText=function(){if(this._event!=EVENT_DELETE&&null!=this._event&&null!=this.SVGWidgetText){if(null!=this.widgetText?this.SVGWidgetText.text=this.widgetText:this.SVGWidgetText.text="",0!=this.SVGWidgetText.width&&(this.SVGWidgetText.x=this.centreX-this.SVGWidgetText.width/2,this.SVGWidgetText.y=this.centreY+this.SVGWidgetText.height/2),null!=this._properties.headertext.value){if(this.SVGHeaderText.text!==this._properties.headertext.value&&(this.SVGHeaderText.text=this._properties.headertext.value,this.SVGHeaderText.width>this.size)){var e=this.SVGHeaderText.width/(this._properties.headertext.value.length+3),t=(this.size-this.size/3)/e;this.SVGHeaderText.text=this._properties.headertext.value.slice(0,parseInt(t))+"..."}}else this.SVGHeaderText.text="";switch(0<this.SVGHeaderText.width&&(this.SVGHeaderText.x=this.centreX-this.SVGHeaderText.width/2,this.SVGHeaderText.y=this.SVGHeaderText.height),this._networkStatus){case NET_ONLINE:this.toColor(this.SVGWidgetText,this._properties.valuetextcolor.value),this.toColor(this.SVGHeaderText,theme.light),this.SVGHint.text=getLang("rid_online"),this.toColor(this.SVGHint,theme.success);break;case NET_ERROR:this.toColor(this.SVGWidgetText,theme.danger),this.toColor(this.SVGHeaderText,theme.danger),this.SVGHint.text=getLang("rid_error"),this.toColor(this.SVGHint,theme.danger);break;case NET_RECONNECT:this.toColor(this.SVGWidgetText,theme.info),this.toColor(this.SVGHeaderText,theme.info),this.SVGHint.text=getLang("rid_connect"),this.toColor(this.SVGHint,theme.info);break;default:this.toColor(this.SVGWidgetText,theme.secondary),this.toColor(this.SVGHeaderText,theme.secondary),this.SVGHint.text=getLang("rid_offline"),this.toColor(this.SVGHint,theme.secondary)}0!=this.SVGHint&&(this.SVGHint.x=this.centreX-this.SVGHint.width/2,this.SVGHint.y=this.height-this.SVGHint.height/2)}},e.prototype.drawWidget=function(){if(this._event!=EVENT_DELETE&&null!=this._event&&null!=this.SVGBackgroundPanel){switch(this.SVGBackgroundPanel.color=this._properties.bordercolor.value,this.SVGBackgroundPanel.fill=this._properties.backgroundcolor.value,this.SVGBackgroundPanel.opacity=this._properties.backgroundopacity.value,this.SVGHeaderPanel.opacity=this._properties.headeropacity.value,this.SVGHeaderPanel.fill=this._properties.headercolor.value,this._networkStatus){case NET_ONLINE:this.SVGBackdownpanel.fill=theme.success;break;case NET_ERROR:this.SVGBackdownpanel.fill=theme.danger;break;case NET_RECONNECT:this.SVGBackdownpanel.fill=theme.info;break;default:this.SVGBackdownpanel.fill=theme.light}if("true"===this._properties.showequalizer.value){for(var e=0;e<this.eCount;e++)for(var t=this.equalizerX[e],i=0;i<5;i++)this._networkStatus==NET_ONLINE?(t[i].fill=theme.secondary,t[i].opacity=.08*(i+1)):t[i].opacity=0;if(this._networkStatus==NET_ONLINE&&null!=this.historyData){var r,s=this.historyData.split(";"),o=s[0],n=o/this.eCount;for(e=0;e<o;e++){t=this.equalizerX[parseInt(e/n)];var a=s[e+1];(null==r||r<a)&&(r=a)}var d=parseFloat(r/5);for(e=0;e<o;e++){if(o<this.eCount)t=this.equalizerX[e];else t=this.equalizerX[parseInt(e/n)];for(a=parseInt(s[e+1]/d),i=0;i<a;i++)t[4-i].opacity=(1-parseFloat(i/4))/2,t[4-i].fill=theme.success}}}else for(e=0;e<this.eCount;e++)for(t=this.equalizerX[e],i=0;i<5;i++)t[i].opacity=0;if(this._networkStatus==NET_RECONNECT){this.spinnerAngle+=1.5,this.SVGArcSpinner.opacity<.8&&(this.SVGArcSpinner.opacity+=.01),this.SVGArcSpinner.draw(this.spinnerAngle,240+this.spinnerAngle);var h=this;requestAnimationFrame(function(){return h.drawWidget()})}else this.SVGArcSpinner.opacity=0,this.SVGArcSpinner.hide()}},e.prototype.resize=function(e){this.size=e,null!=this.SVGWidgetText&&(this.SVGViewBox.setAttributeNS(null,"width",e),this.SVGViewBox.setAttributeNS(null,"height",e))},e.prototype.onPanelResize=function(){var e=document.getElementsByTagName("BODY")[0];for(var t in e.widgets){var i=e.widgets[t];window.innerWidth,i.resize(i.widgetHolder.clientWidth)}},e.prototype.showProperties=function(t){t.storedProperties={},t.inParentIndex=Array.prototype.slice.call(t.parentPanel.childNodes).indexOf(t.widgetHolder),t.inParentClass=t.widgetHolder.className,t.parentPanel.removeChild(t.widgetHolder),t.widgetHolder.className="col-sm-4",t.mode=WORK_MODE,makeModalDialog("resetPanel","showProperties",getLang("showproperties"),"");var e=document.getElementById("showPropertiesModalBody"),i=document.getElementById("showPropertiesModalFooter"),r=e.appendChild(document.createElement("div"));r.className="driversWidgetsPanel d-flex justify-content-center",r.appendChild(t.widgetHolder);var s=e.appendChild(document.createElement("ul"));s.className="nav nav-tabs";var o=e.appendChild(document.createElement("div"));o.className="tab-content";var n=!0;for(var a in t.properties){t.storedProperties[a]={tab:t.properties[a].tab,value:t.properties[a].value,type:t.properties[a].type};var d=t.properties[a].tab;"G"===d?d="General":"C"===d?d="Color":"O"===d&&(d="Opacity");var h=document.getElementById(d+"PropTab"),l=document.getElementById(d+"PropForm");if(null==l){var p=s.appendChild(document.createElement("li"));p.className="nav-item";var c=p.appendChild(document.createElement("a"));c.setAttribute("data-toggle","tab"),c.href="#"+d+"PropTab",c.innerText=d,(h=o.appendChild(document.createElement("div"))).id=d+"PropTab",(l=h.appendChild(document.createElement("div"))).className="form-group",l.id=d+"PropForm",n?(c.className="nav-link active",n=!(h.className="tab-pane fade show active")):(c.className="nav-link",h.className="tab-pane fade")}var g=l.appendChild(document.createElement("div"));g.className="input-group input-group-sm mb-3";var u=g.appendChild(document.createElement("div"));u.className="input-group-prepend";var w=u.appendChild(document.createElement("label"));w.className="input-group-text",w.setAttribute("for","hostEdit"),w.innerText=a;var v=createValueEdit(g,t.properties[a].name,t.properties[a].value,t.properties[a].type);v.className="form-control form-control-sm",v.placeholder="type value here",v.id="widgetproperty"+a,v.widgetProperty=t.properties[a],v.widget=t,v.originalOnChange=v.onchange,v.onchange=t.onPropertyChange,v.onkeyup=t.onPropertyChange}var f=l.appendChild(document.createElement("label"));f.className="text-danger";var S=document.getElementById("showPropertiescloseHeaderButton");S.widget=t,S.onclick=t.discardProperties;var m=document.getElementById("showPropertiescloseButton");m.widget=t,m.onclick=t.discardProperties;var V=i.appendChild(document.createElement("button"));V.type="button",V.className="btn btn-sm btn-warning",V.id="allwidgetsModalButton",V.widget=t,V.onclick=t.setAllWidgetsProperties,V.innerText=getLang("setallwidgetspropbutton"),V.setPropError=f;var y=i.appendChild(document.createElement("button"));y.type="button",y.className="btn btn-sm btn-success",y.id="addnodeModalButton",y.widget=t,y.onclick=t.setProperties,y.innerText=getLang("setpropbutton"),y.setPropError=f,$("#showPropertiesModal").on("hidden.bs.modal",function(e){if(null==document.getElementById("showPropertiesModal").setProp){e={currentTarget:S};t.discardProperties(e)}}),$("#showPropertiesModal").modal("show")},e.prototype.setProperties=function(e){e.stopPropagation();var t=e.currentTarget.widget;return t.widgetHolder.parentElement.removeChild(t.widgetHolder),t.parentPanel.insertBefore(t.widgetHolder,t.parentPanel.childNodes[t.inParentIndex]),t.widgetHolder.className=t.inParentClass,t.mode=MOVE_MODE,t.doOnChange(),document.getElementById("showPropertiesModal").setProp=!0,$("#showPropertiesModal").modal("hide"),!1},e.prototype.setAllWidgetsProperties=function(e){e.stopPropagation();var t=e.currentTarget.widget;t.widgetHolder.parentElement.removeChild(t.widgetHolder),t.parentPanel.insertBefore(t.widgetHolder,t.parentPanel.childNodes[t.inParentIndex]),t.widgetHolder.className=t.inParentClass,t.mode=MOVE_MODE;var i=document.getElementsByTagName("BODY")[0];for(var r in i.widgets){var s=i.widgets[r];for(var o in s.properties)if("headertext"!==o){var n=document.getElementById("widgetproperty"+o);null!=n&&(s.properties[o].value=n.value)}s.properties=s.properties}return t.doOnChange(),document.getElementById("showPropertiesModal").setProp=!0,$("#showPropertiesModal").modal("hide"),!1},e.prototype.discardProperties=function(e){null!=e.stopPropagation&&e.stopPropagation();var t=e.currentTarget.widget;return t.widgetHolder.parentElement.removeChild(t.widgetHolder),t.parentPanel.insertBefore(t.widgetHolder,t.parentPanel.childNodes[t.inParentIndex]),t.widgetHolder.className=t.inParentClass,t.mode=MOVE_MODE,t.properties=t.storedProperties,document.getElementById("showPropertiesModal").setProp=!0,$("#showPropertiesModal").modal("hide"),!1},e.prototype.onPropertyChange=function(e){var t=e.currentTarget,i=t.widget;for(var r in i.properties){var s=document.getElementById("widgetproperty"+r);i.properties[r].value=s.value}return i.properties=i.properties,null!=t.originalOnChange&&t.originalOnChange(e),!0},e.prototype.moveLeft=function(e){var t=e.currentTarget.widget;if(t.mode==MOVE_MODE){var i=Array.prototype.slice.call(t.parentPanel.childNodes).indexOf(t.widgetHolder);t.parentPanel.removeChild(t.widgetHolder),t.parentPanel.insertBefore(t.widgetHolder,t.parentPanel.childNodes[i-1])}return!0},e.prototype.moveRight=function(e){var t=e.currentTarget.widget;if(t.mode==MOVE_MODE){var i=Array.prototype.slice.call(t.parentPanel.childNodes).indexOf(t.widgetHolder);t.parentPanel.removeChild(t.widgetHolder),t.parentPanel.insertBefore(t.widgetHolder,t.parentPanel.childNodes[i+1])}return!0},e.prototype.propertiesClick=function(e){e.stopPropagation();var t=e.currentTarget.widget;return t.mode==MOVE_MODE&&t.showProperties(t),!0},e.prototype.plusSize=function(e){var t=e.currentTarget.widget;return t.mode==MOVE_MODE&&(t.SVGViewBox.setAttributeNS(null,"width",t.width+=25),t.SVGViewBox.setAttributeNS(null,"height",t.height+=25)),!0},e.prototype.deleteWidget=function(){this.event=EVENT_DELETE,this.doOnDelete();var e=document.getElementsByTagName("BODY")[0];if(e.onresize==this.onPanelResize)for(var t in e.onresize=null,e.widgets){var i=e.widgets[t];if(i!=this){e.onresize=i.onPanelResize;break}}for(e.widgets.splice(e.widgets.indexOf(this),1);0!=this.SVGViewBox.childNodes.length;)this.SVGViewBox.removeChild(this.SVGViewBox.childNodes[0]);for(var r in this.widgetHolder.removeChild(this.SVGViewBox),this.parentPanel.removeChild(this.widgetHolder),this.widgetHolder.innerHTML="",this)this.hasOwnProperty(r)&&delete this[r]},e.prototype.deleteWidgetClick=function(e){var t=e.currentTarget.widget;return t.mode==MOVE_MODE&&(t.deleteWidget(),t=null),!0},e.prototype.modeChangeClick=function(e){var t=e.currentTarget.widget;return t.mode==WORK_MODE?t.mode=MOVE_MODE:t.mode=WORK_MODE,!0},e.prototype.clickableToTop=function(){this.SVGViewBox.insertBefore(this.SVGWidgetText.SVGText,this.SVGViewBox.childNodes.lastChild),this.SVGViewBox.insertBefore(this.SVGLeftIcon.SVGIcon,this.SVGViewBox.childNodes.lastChild),this.SVGViewBox.insertBefore(this.SVGRightIcon.SVGIcon,this.SVGViewBox.childNodes.lastChild),this.SVGViewBox.insertBefore(this.SVGDeleteIcon.SVGIcon,this.SVGViewBox.childNodes.lastChild),this.SVGViewBox.insertBefore(this.SVGPropertiesIcon.SVGIcon,this.SVGViewBox.childNodes.lastChild)},e.prototype.mouseOver=function(e){var t=e.currentTarget.widget;return t.mouseEnter=!0,t.drawMouseEnter(),!0},e.prototype.mouseOut=function(e){var t=e.currentTarget.widget;return t.mouseEnter=!1,t.drawMouseEnter(),!0},e.prototype.refresh=function(e,t,i,r){this._event!=EVENT_DELETE&&null!=this._event&&(this._data==e&&this.widgetText==t&&this._properties.headertext==i||("---"===this._properties.headertext.value&&(this._properties.headertext.value=i),this.widgetText!=t&&speak(this._properties.headertext+" "+t),this.historyData=r,this._data=e,this.widgetText=t,this.spinnerAngle=0,this.redrawAll()))},e.prototype.redrawAll=function(){if(this._event!=EVENT_DELETE&&null!=this._event){var e=this;this.starttime=0,requestAnimationFrame(function(){return e.drawWidget()}),this.drawText()}},e.prototype.toColor=function(e,t,i){null==i&&(i=!0),null!=e&&(null==e.animantion&&(e.animantion=!1),e.animantion&&(e.animantion=!1,window.cancelAnimationFrame(e.animantionFrame),this.animateColor(e,t,i)),e.animantion=!0,this.animateColor(e,t,i))},e.prototype.animateColor=function(e,t,i){var r=this;if(e.animantion){var s=e.colorRGB,o=colorToRGB(t);if(s[0]==o[0]&&s[1]==o[1]&&s[2]==o[2])return window.cancelAnimationFrame(e.animantionFrame),void(e.animantion=!1);s[0]!=o[0]&&(s[0]<o[0]?s[0]++:s[0]--),s[1]!=o[1]&&(s[1]<o[1]?s[1]++:s[1]--),s[2]!=o[2]&&(s[2]<o[2]?s[2]++:s[2]--),e.colorRGB=s,i||(e.fillRGB=s),e.animantion&&(e.animantionFrame=window.requestAnimationFrame(function(){return r.animateColor(e,t,i)}))}},e.prototype.drawMouseEnter=function(){if(this._mode==WORK_MODE){var e=this;this.mouseEnter?this.SVGBackgroundPanel.opacity>this._properties.backgroundselectopacity.value&&(this.SVGBackgroundPanel.opacity-=.05,requestAnimationFrame(function(){return e.drawMouseEnter()})):this.SVGBackgroundPanel.opacity<this._properties.backgroundopacity.value&&(this.SVGBackgroundPanel.opacity+=.005,requestAnimationFrame(function(){return e.drawMouseEnter()}))}},e.prototype.defaultWidgetProperties=function(){return{headertext:{tab:"G",value:"---",type:"s"},headercolor:{tab:"C",value:theme.secondary,type:"c"},headeropacity:{tab:"O",value:.1,type:"f"},backgroundcolor:{tab:"C",value:theme.dark,type:"c"},backgroundopacity:{tab:"O",value:1,type:"f"},bordercolor:{tab:"C",value:theme.secondary,type:"c"},backgroundselectopacity:{tab:"O",value:.2,type:"f"},valuetextcolor:{tab:"C",value:theme.light,type:"c"},showequalizer:{tab:"G",value:"false",type:"b"}}},e.prototype.doOnLoad=function(){if(null!=this._onload)for(var e in this._onload)this._onload[e](this)},e.prototype.doOnChange=function(){if(null!=this._onchange)for(var e in this._onchange)this._onchange[e](this)},e.prototype.doOnDelete=function(){if(null!=this._ondelete)for(var e in this._ondelete)this._ondelete[e](this)},_createClass(e,[{key:"mode",set:function(e){this._event!=EVENT_DELETE&&null!=this._event&&((this._mode=e)==WORK_MODE?(this.SVGBackgroundPanel.opacity=this._properties.backgroundopacity.value,this.SVGLeftIcon.hide(),this.SVGRightIcon.hide(),this.SVGDeleteIcon.hide(),this.SVGPropertiesIcon.hide()):e==MOVE_MODE&&(this.SVGBackgroundPanel.opacity=this._properties.backgroundopacity.value/3,this.SVGLeftIcon.draw(),this.SVGRightIcon.draw(),this.SVGDeleteIcon.draw(),this.SVGPropertiesIcon.draw()))},get:function(){return this._mode}},{key:"networkStatus",get:function(){return this._networkStatus},set:function(e){this._event!=EVENT_DELETE&&null!=this._event&&e>=NET_OFFLINE&&e<=NET_RECONNECT&&(this._networkStatus=e,this.redrawAll())}},{key:"properties",get:function(){return this._properties},set:function(e){this._event!=EVENT_DELETE&&null!=this._event&&null!=e&&(this._properties=e,this.drawText(),this.drawWidget())}},{key:"data",get:function(){return this._data},set:function(e){this._event!=EVENT_DELETE&&null!=this._event&&(this._data=e,this.redrawAll())}},{key:"onload",set:function(e){null==this._onload&&(this._onload=[]),this._onload.push(e)}},{key:"onchange",set:function(e){null==this._onchange&&(this._onchange=[]),this._onchange.push(e)}},{key:"ondelete",set:function(e){null==this._ondelete&&(this._ondelete=[]),this._ondelete.push(e)}}]),e}(),GraphWidget=function(r){"use strict";function e(e,t,i){return r.call(this,e,t,i)||this}return _inheritsLoose(e,r),e.prototype.onWidgetHolderLoad=function(e){r.prototype.onWidgetHolderLoad.call(this,e);var t=e.currentTarget.widget;t.widgetHolder.className="col-6 col-sm-4 col-lg-2",t.topMargin=t.size/20,t.width=2*t.size,t.height=t.size,t.centreX=t.width/2,t.widgetTextSize=t.size/110,t.graphWidth=t.width-t.panding,t.graphHeight=t.height-t.size/3.4,t.graphTop=t.size/3.7,t.SVGViewBox.setAttributeNS(null,"viewBox","0 0 "+t.width+" "+t.height),t.SVGBackgroundPanel.drawRoundedRect(t.width-5,t.height-6,5,10,!0,!0,!0,!0),t.SVGBackdownpanel.drawRoundedRect(t.width-5,10,5,0,!1,!1,!0,!0),t.SVGHeaderPanel.drawRoundedRect(t.width,26,5,0,!0,!0,!1,!1),t._properties.lineColor={tab:"Graph",value:theme.success,type:"c"},t._properties.lineOpacity={tab:"Graph",value:.5,type:"f"},t._properties.backOpacity={tab:"Graph",value:.4,type:"f"},t._properties.gradient1Color={tab:"Graph",value:theme.success,type:"c"},t._properties.gradient1Opacity={tab:"Graph",value:.7,type:"f"},t._properties.gradient1Offset={tab:"Graph",value:0,type:"i"},t._properties.gradient2Color={tab:"Graph",value:theme.success,type:"c"},t._properties.gradient2Opacity={tab:"Graph",value:.4,type:"f"},t._properties.gradient2Offset={tab:"Graph",value:60,type:"i"},t._properties.gradient3Color={tab:"Graph",value:theme.success,type:"c"},t._properties.gradient3Opacity={tab:"Graph",value:.2,type:"f"},t._properties.gradient3Offset={tab:"Graph",value:80,type:"i"},t.SVGBackdownpanel.width=t.width,t.stop1=document.createElementNS(xmlns,"stop"),t.stop2=document.createElementNS(xmlns,"stop"),t.stop2.setAttribute("class","stop2"),t.stop3=document.createElementNS(xmlns,"stop"),t.stop3.setAttribute("class","stop3"),t.gradient=document.createElementNS(xmlns,"linearGradient"),t.gradient.id=t.id+"GraphGradient",t.gradient.setAttribute("x1","0"),t.gradient.setAttribute("x2","0"),t.gradient.setAttribute("y1","0"),t.gradient.setAttribute("y2","1"),t.gradient.appendChild(t.stop1),t.gradient.appendChild(t.stop2),t.gradient.appendChild(t.stop3),t.SVGViewBox.appendChild(t.gradient),t.SVGPath1=new SVGArc(t.SVGViewBox,t.id+"path1",t.graphTop+" "+t.halfPanding+" "+t.graphWidth+" "+t.graphHeight),t.SVGPath1.fill="url(#"+t.id+"GraphGradient)",t.SVGPath2=new SVGArc(t.SVGViewBox,t.id+"path2",t.graphTop+" "+t.halfPanding+" "+t.graphWidth+" "+t.graphHeight),t.SVGHeaderText.text="Graph",t.widgetLeft=t.centreX-t.textWidth/2,t.widgetTop=t.centreY+t.SVGHeaderText.height-4*t.textHeight/2;var i=t.size/210;t.SVGTopLabel=new SVGText(t.SVGViewBox,t.id+"toplabel",i),t.SVGTopLabel.color=theme.secondary,t.SVGMiddleLabel=new SVGText(t.SVGViewBox,t.id+"toplabel",i),t.SVGMiddleLabel.color=theme.secondary,t.SVGDownLabel=new SVGText(t.SVGViewBox,t.id+"toplabel",i),t.SVGDownLabel.color=theme.secondary,t.SVGTopLabel.x=t.SVGMiddleLabel.x=t.SVGDownLabel.x=t.width/40,t.SVGTopLine=new SVGRect(t.SVGViewBox,t.id+"topline",t.width/48,0,t.graphWidth,1),t.SVGTopLine.opacity=.1,t.SVGTopLine.color=theme.secondary,t.SVGMiddleLine=new SVGRect(t.SVGViewBox,t.id+"middlieline",t.width/48,0,t.graphWidth,1),t.SVGMiddleLine.opacity=.1,t.SVGMiddleLine.color=theme.secondary,t.SVGDownLine=new SVGRect(t.SVGViewBox,t.id+"downline",t.width/48,0,t.graphWidth,1),t.SVGDownLine.opacity=.1,t.SVGDownLine.color=theme.secondary,t.SVGIcon=new SVGIcon(t.SVGViewBox,addIcon,t.width-t.size/6,t.size/24,t.size/8,t.size/8),t.SVGIcon.fill=theme.secondary,t.SVGWidgetText.hide(),t.SVGArcSpinner.x=t.centreX,t.ShowEqualizer=!1,t.SVGRightIcon.x=t.width-t.rowSize,t.SVGPropertiesIcon.x=t.width/2-t.rowSize/2,t.SVGDeleteIcon.x=t.width-t.rowSize+t.size/55,t.clickableToTop(),t.proprties=t._properties,t.resize(t.width),t.doOnLoad()},e.prototype.resize=function(e){this.size=e,this.SVGViewBox.setAttributeNS(null,"width",e),this.SVGViewBox.setAttributeNS(null,"height",e/2)},e.prototype.refresh=function(e,t,i){t=getLang(t),this.widgetText=e,this.label=t,this.historyData=i,this.spinnerAngle=0,this.redrawAll()},e.prototype.drawText=function(){r.prototype.drawText.call(this)},e.prototype.drawWidget=function(){if(null!=this.graphWidth&&null!=this.historyData){this.stop1.setAttribute("stop-color",this.properties.gradient1Color.value),this.stop1.setAttribute("stop-opacity",this.properties.gradient1Opacity.value),this.stop1.setAttribute("offset",this.properties.gradient1Offset.value+"%"),this.stop2.setAttribute("stop-color",this.properties.gradient2Color.value),this.stop2.setAttribute("stop-opacity",this.properties.gradient2Opacity.value),this.stop2.setAttribute("offset",this.properties.gradient2Offset.value+"%"),this.stop3.setAttribute("stop-color"," "+this.properties.gradient3Color.value),this.stop3.setAttribute("stop-opacity",this.properties.gradient3Opacity.value),this.stop3.setAttribute("offset",this.properties.gradient3Offset.value+"%");var e=this.historyDataFilter(this.graphWidth,this.historyData,1,1);this.grawYValuesPoints(this.SVGTopLabel,this.SVGMiddleLabel,this.SVGDownLabel,e);var t=this.curveForDrawing(e,this.graphHeight,this.graphTop,this.panding);switch(this._networkStatus){case NET_ONLINE:this.SVGPath1.opacity=this._properties.backOpacity.value,this.SVGPath2.opacity=this._properties.lineOpacity.value,this.toColor(this.SVGPath2,this._properties.lineColor.value),this.toColor(this.SVGTopLabel,theme.secondary),this.toColor(this.SVGMiddleLabel,theme.secondary),this.toColor(this.SVGDownLabel,theme.secondary),this.SVGIcon.fill=this._properties.backOpacity.value;break;case NET_ERROR:this.SVGPath1.opacity=0,this.toColor(this.SVGPath2,theme.danger),this.toColor(this.SVGTopLabel,theme.danger),this.toColor(this.SVGMiddleLabel,theme.danger),this.toColor(this.SVGDownLabel,theme.danger),this.SVGIcon.fill=theme.danger;break;case NET_RECONNECT:this.SVGPath1.opacity=0,this.toColor(this.SVGPath2,theme.info),this.toColor(this.SVGTopLabel,theme.info),this.toColor(this.SVGMiddleLabel,theme.info),this.toColor(this.SVGDownLabel,theme.info),this.SVGIcon.fill=theme.info;break;default:this.SVGPath1.opacity=0,this.toColor(this.SVGPath2,theme.secondary),this.toColor(this.SVGTopLabel,theme.secondary),this.toColor(this.SVGMiddleLabel,theme.secondary),this.toColor(this.SVGDownLabel,theme.secondary),this.SVGIcon.fill=theme.secondary}this.SVGTopLabel.y=this.SVGTopLine.y=this.graphTop,this.SVGTopLine.x=this.SVGTopLabel.x+this.SVGTopLabel.width,this.SVGMiddleLabel.y=this.SVGMiddleLine.y=this.graphTop+this.graphHeight/2,this.SVGMiddleLine.x=this.SVGMiddleLabel.x+this.SVGMiddleLabel.width,this.SVGDownLabel.y=this.SVGDownLine.y=this.graphTop+this.graphHeight-this.size/100,this.SVGDownLine.x=this.SVGDownLabel.x+this.SVGDownLabel.width,this.SVGPath1.drawPath(t),this.SVGPath2.drawPath(t),r.prototype.drawWidget.call(this)}},e.prototype.isIntegerNumber=function(e){return(0^e)===e},e.prototype.grawYValuesPoints=function(e,t,i,r){for(var s,o,n,a=0;a<r.length;a++){var d=parseFloat(r[a]);(null==s||s<d)&&(s=d),(null==o||d<o)&&(o=d)}n=o==s?(o-=.1*o)+((s+=.1*s)-o)/2:(o-=n=(s-o)/2)+((s+=n)-o)/2,this.isIntegerNumber(s)&&this.isIntegerNumber(n)&&this.isIntegerNumber(o)||(s=s.toFixed(2),o=o.toFixed(2),n=n.toFixed(2)),e.text=s,t.text=n,i.text=o},e.prototype._trunc=function(e){return isNaN(e)?NaN:0<e?Math.floor(e):Math.ceil(e)},e.prototype.grawXValues=function(e,t,i,r,s,o,n,a,d){var h,l=3*(this._trunc((i-20)/30)+1),p=n.split(";").length-1;if(p<=l){h=new Array(p);for(var c=0;c<h.length;c++)h[c]=a-1e3*d*60*(h.length-1-c)}else{h=new Array(l);var g=0;1440<p&&(g=p-1440);var u=p-g,w=_trunc(u/h.length),v=u-w*h.length;if(v<=0)for(var f=0;f<h.length;f++)h[f]=a-6e4*d*w*(h.length-(f+1));else for(var S=0;S<h.length;S++)h[S]=a-6e4*d*(v+w*(h.length-(S+1)))}var m=new Date(h[0]),V=new SVGText(e,t+"startXValue",r/255);V.x=o,V.y=s+r+10,V.text=m.getHours()+":"+m.getMinutes();V.getTextWidth();var y=new Date(h[h.length-1]),x=new SVGText(e,t+"finishXValue",r/255);x.x=o+_trunc(i/h.length)*(h.length-1)-20,x.y=s+r+10,x.text=y.getHours()+":"+y.getMinutes()},e.prototype.curveForDrawing=function(e,t,i,r){for(var s,o,n=0;n<e.length;n++){var a=parseFloat(e[n]);(null==s||s<a)&&(s=a),(null==o||a<o)&&(o=a)}if(s==o)s+=.1*s,o-=.1*o;else{var d=(s-o)/2;s+=d,o-=d}for(var h=t/(s-o),l=0;l<e.length;l++)e[l]=parseFloat(i+(t-(e[l]-o)*h));for(var p=parseFloat(t+i),c="M "+r+", "+p,g=0;g<e.length;g++)if(0==g)c+=" C "+r+", "+e[g]+" "+r+", "+p+" "+r+", "+e[g]+" ";else{var u=parseFloat(r+10*g-10/3*2),w=parseFloat(r+10*g-10/3),v=parseFloat(r+10*g);c+=" C "+u+", "+e[g-1]+" "+w+", "+e[g]+" "+v+", "+e[g]+" "}return c+=" C "+parseFloat(r+10*(e.length-1))+","+p+" "+parseFloat(r+10*(e.length-1))+","+p+" "+parseFloat(r+10*(e.length-1))+","+p+" "},e.prototype.historyDataFilter=function(e,t){var i,r=3*(this._trunc((e-20)/30)+1),s=t.split(";"),o=s.length-1;if(o<=r){i=new Array(o);for(var n=0;n<i.length;n++)i[n]=s[n]}else{var a=3*this._trunc(r/3);i=new Array(a);for(var d=this._trunc(3*o/i.length),h=o-i.length*d/3,l=0;l<i.length/3;l++){for(var p,c,g,u,w,v,f,S=0;S<d;S++){var m=parseFloat(s[h+d*l+S]);(null==p||null==p||p<m)&&(p=m,u=h+d*l+S),(null==c||null==c||m<c)&&(c=m,w=h+d*l+S),0==S?g=m:g+=m}if(c==p)g=(c+p)/2,i[3*l]=c,i[3*l+1]=g,i[3*l+2]=p;else{g/=d;for(var V=0;V<d;V++){var y=parseFloat(s[h+d*l+V]);(null==f||null==f||Math.abs(g-y)<f)&&(f=Math.abs(g-y),v=h+d*l+V)}w<u?w<v?(i[3*l]=c,v<u?(i[3*l+1]=g,i[3*l+2]=p):(i[3*l+1]=p,i[3*l+2]=g)):(i[3*l]=g,i[3*l+1]=c,i[3*l+2]=p):v<u?(i[3*l]=g,i[3*l+1]=p,i[3*l+2]=c):(i[3*l]=p,v<w?(i[3*l+1]=g,i[3*l+2]=c):(i[3*l+1]=c,i[3*l+2]=g))}f=v=w=u=g=c=p=null}}return i},e}(BaseWidget),LCDWidget=function(r){"use strict";function e(e,t,i){return r.call(this,e,t,i)||this}return _inheritsLoose(e,r),e.prototype.onWidgetHolderLoad=function(e){r.prototype.onWidgetHolderLoad.call(this,e);var t=e.currentTarget.widget;t.widgetHolder.className="col-6 col-sm-4 col-lg-2",t.topMargin=t.size/20,t.width=2*t.size,t.height=t.size,t.centreX=t.width/2,t.widgetTextSize=t.size/110,t.SVGViewBox.setAttributeNS(null,"viewBox","0 0 "+t.width+" "+t.height),t.SVGBackgroundPanel.drawRoundedRect(t.width,t.height,5,10,!0,!0,!0,!0),t.SVGHeaderPanel.drawRoundedRect(t.width,26,5,0,!0,!0,!1,!1),t.SVGBackdownpanel.y+=3,t.SVGBackdownpanel.drawRoundedRect(t.width,10,5,0,!1,!1,!0,!0),t.SVGWidgetText1=new SVGText(t.SVGViewBox,t.id+"widgettext1",t.widgetTextSize),t.SVGWidgetText1.fontFamily="monospace",t.SVGWidgetText2=new SVGText(t.SVGViewBox,t.id+"widgettext2",t.widgetTextSize),t.SVGWidgetText2.fontFamily="monospace",t.SVGWidgetText3=new SVGText(t.SVGViewBox,t.id+"widgettext3",t.widgetTextSize),t.SVGWidgetText3.fontFamily="monospace",t.SVGWidgetText4=new SVGText(t.SVGViewBox,t.id+"widgettext4",t.widgetTextSize),t.SVGWidgetText4.fontFamily="monospace",t.SVGWidgetText1.text="1234567890ABCSDEFGHL",t.SVGHeaderText.text="LCD",t.textWidth=t.SVGWidgetText1.width,t.textHeight=t.SVGWidgetText1.height,t.widgetLeft=t.centreX-t.textWidth/2,t.widgetTop=t.centreY+t.SVGHeaderText.height-4*t.textHeight/2,t.SVGWidgetBack=new SVGRect(t.SVGViewBox,t.id+"widgetback",t.widgetLeft-t.panding,t.widgetTop-parseFloat(t.textHeight-t.panding),t.textWidth+2*t.panding,4*t.textHeight+t.panding),t.SVGWidgetBack.opacity=.2,t.SVGWidgetBack.color=theme.secondary,t.SVGWidgetText1.text="",t.SVGHeaderText.text="",t.SVGWidgetText.hide(),t.SVGArcSpinner.x=t.centreX,t.widgetHolder.onclick=t.showEditor,t.pre=t.widgetHolder.appendChild(document.createElement("pre")),t.pre.className="LCDTextArea",t.pre.style.display="none",t.textarea=t.pre.appendChild(document.createElement("textarea")),t.textarea.className="form-control text-white bg-primary",t.textarea.id="textarea"+t.id,t.textarea.rows="4",t.textarea.cols="25";var i=t.pre.getBoundingClientRect().height;t.pre.style.marginTop=-(i/2+t.size/1.8)+"px",t.btnGroup=t.widgetHolder.appendChild(document.createElement("p")),t.btnGroup.style.display="none",t.btnGroup.className="LCDButtons",t.btnGroup.role="group",t.textElement=t.btnGroup.appendChild(document.createElement("div")),t.textElement.className="text-white",t.lcdButton=t.btnGroup.appendChild(document.createElement("input")),t.lcdButton.className="btn btn-success text-white LCDButton",t.lcdButton.id=t.id+"lcdbutton",t.lcdButton.type="button",t.lcdButton.edit=t.textarea,t.lcdButton.lcdid=t.id,t.lcdButton.widget=_assertThisInitialized(t),t.lcdButton.value=getLang("send"),t.lightButton=t.btnGroup.appendChild(document.createElement("input")),t.lightButton.className="btn btn-info text-white LCDButton",t.lightButton.id=t.id+"clearbutton",t.lightButton.type="button",t.lightButton.edit=t.textarea,t.lightButton.lcdid=t.id,t.lightButton.widget=_assertThisInitialized(t),t.lightButton.value=getLang("shortlight"),t.ShowEqualizer=!1,t.proprties=t._properties,t.resize(t.width),t.doOnLoad()},e.prototype.resize=function(e){this.size=e,this.SVGViewBox.setAttributeNS(null,"width",e),this.SVGViewBox.setAttributeNS(null,"height",e/2)},e.prototype.refresh=function(e,t,i){t=getLang(t),this.widgetText=e,this.label=t,this.spinnerAngle=0,this.light=null!=i?i:0,this.redrawAll()},e.prototype.showEditor=function(e){e.stopPropagation();var t=e.currentTarget.widget;return-1!=!t.pre.style.display.indexOf("block")&&(t.textarea.value=t.widgetText,t.pre.style.display="block",t.btnGroup.style.display="block"),!0},e.prototype.hideEditor=function(){this.pre.style.display="none",this.btnGroup.style.display="none"},e.prototype.drawText=function(){if(r.prototype.drawText.call(this),null!=this.SVGWidgetText1){switch(this._networkStatus){case NET_ONLINE:this.SVGWidgetText1.color=theme.light,this.SVGWidgetText2.color=theme.light,this.SVGWidgetText3.color=theme.light,this.SVGWidgetText4.color=theme.light;break;case NET_RECONNECT:this.SVGWidgetText1.color=theme.info,this.SVGWidgetText2.color=theme.info,this.SVGWidgetText3.color=theme.info,this.SVGWidgetText4.color=theme.info;break;default:this.SVGWidgetText1.color=theme.secondary,this.SVGWidgetText2.color=theme.secondary,this.SVGWidgetText3.color=theme.secondary,this.SVGWidgetText4.color=theme.secondary}null==this.widgetText&&(this.widgetText=""),this.SVGWidgetText1.text=this.widgetText.substring(0,20),this.SVGWidgetText2.text=this.widgetText.substring(20,40),this.SVGWidgetText3.text=this.widgetText.substring(40,60),this.SVGWidgetText4.text=this.widgetText.substring(60),this.SVGWidgetText1.x=this.widgetLeft,this.SVGWidgetText1.y=this.widgetTop,this.SVGWidgetText2.x=this.widgetLeft,this.SVGWidgetText2.y=this.SVGWidgetText1.y+this.SVGWidgetText1.height,this.SVGWidgetText3.x=this.widgetLeft,this.SVGWidgetText3.y=this.SVGWidgetText2.y+this.SVGWidgetText2.height,this.SVGWidgetText4.x=this.widgetLeft,this.SVGWidgetText4.y=this.SVGWidgetText3.y+this.SVGWidgetText4.height,this.SVGHeaderText.text=this.label,this.SVGHeaderText.x=this.width/2-this.SVGHeaderText.width/2,this.SVGHeaderText.y=this.SVGHeaderText.height-this.panding}},e.prototype.drawWidget=function(){null!=this.SVGWidgetBack&&(1==this.light?this.SVGWidgetBack.color=theme.info:this.SVGWidgetBack.color=theme.secondary,r.prototype.drawWidget.call(this))},e}(BaseWidget),LightWidget=function(s){"use strict";function e(e,t,i){return s.call(this,e,t,i)||this}return _inheritsLoose(e,s),e.prototype.onWidgetHolderLoad=function(e){s.prototype.onWidgetHolderLoad.call(this,e);var t=e.currentTarget.widget;t.radius=t.size/10,t.topMargin=t.height-t.size/6,t.animated=!1,t.levelArc=[];for(var i=1;i<5;i++){var r=new SVGArc(t.SVGViewBox,t.id+"arcback1"+i,t.centreX,t.topMargin,i*t.radius,t.size/14);r.index=i,r.opacity=.2*i,t.levelArc.push(r)}t.SVGArcSpinner.y=t.topMargin,t.SVGArcSpinner.radius=4.5*t.radius,t.clickableToTop(),t._properties.lightcolor={tab:"C",value:theme.warning,type:"c"},t.properties=t._properties,t.doOnLoad()},e.prototype.refresh=function(e,t,i){t=getLang(t),s.prototype.refresh.call(this,e,t,i)},e.prototype.drawText=function(){s.prototype.drawText.call(this),null!=this.SVGWidgetText&&(this.SVGWidgetText.y=this.size/5+this.SVGWidgetText.height/2)},e.prototype.drawWidget=function(){if(s.prototype.drawWidget.call(this),null!=this.levelArc){for(var e=0;e<4;e++)switch(this.levelArc[e].hide(),this._networkStatus){case NET_ONLINE:this.toColor(this.levelArc[e],this.properties.lightcolor.value);break;case NET_ERROR:this.toColor(this.levelArc[e],theme.danger);break;case NET_RECONNECT:this.toColor(this.levelArc[e],theme.info);break;default:this.toColor(this.levelArc[e],theme.secondary)}30<this._data&&this.levelArc[0].draw(270,450),50<this._data&&this.levelArc[1].draw(270,450),70<this._data&&this.levelArc[2].draw(270,450),90<this._data&&this.levelArc[3].draw(270,450)}},e}(BaseWidget),MotionWidget=function(a){"use strict";function e(e,t,i){return a.call(this,e,t,i)||this}return _inheritsLoose(e,a),e.prototype.onWidgetHolderLoad=function(e){a.prototype.onWidgetHolderLoad.call(this,e);var t=e.currentTarget.widget;t.radius=t.size/30,t.topMargin=t.centreY+t.size/20,t.animated=!1,t.radar1=[],t.radar2=[],t.radar3=[],t.radar4=[];for(var i=1;i<5;i++){var r=new SVGArc(t.SVGViewBox,t.id+"arcback1"+i,t.centreX,t.topMargin,i*t.radius,t.size/34),s=new SVGArc(t.SVGViewBox,t.id+"arcback2"+i,t.centreX,t.topMargin,i*t.radius,t.size/34),o=new SVGArc(t.SVGViewBox,t.id+"arcback3"+i,t.centreX,t.topMargin,i*t.radius,t.size/34),n=new SVGArc(t.SVGViewBox,t.id+"arcback4"+i,t.centreX,t.topMargin,i*t.radius,t.size/34);r.index=s.index=o.index=n.index=i,r.color=s.color=o.color=n.color=theme.success,t.radar1.push(r),t.radar2.push(s),t.radar3.push(o),t.radar4.push(n)}t.SVGArcSpinner.y=t.topMargin,t.clickableToTop(),t.proprties=t._properties,t.doOnLoad()},e.prototype.refresh=function(e,t,i,r){t=getLang(t),a.prototype.refresh.call(this,e,t,i,r)},e.prototype.drawText=function(){a.prototype.drawText.call(this)},e.prototype.animate=function(){var e=this;if(null!=this.radar1&&this.animated){for(var t=0;t<4;t++)this.radar1[t].radius+=.5,this.radar1[t].opacity-=.01,this.radar1[t].radius>8*this.radius&&(this.radar1[t].radius=this.radius,this.radar1[t].opacity=.9),this.radar1[t].draw(285,335),this.radar2[t].radius=this.radar3[t].radius=this.radar4[t].radius=this.radar1[t].radius,this.radar2[t].opacity=this.radar3[t].opacity=this.radar4[t].opacity=this.radar1[t].opacity,this.radar2[t].draw(15,75),this.radar3[t].draw(106,165),this.radar4[t].draw(195,255);requestAnimationFrame(function(){return e.animate()})}},e.prototype.drawWidget=function(){var e=this;if(a.prototype.drawWidget.call(this),null!=this.radar1)if(this._networkStatus==NET_ONLINE&&1==this._data)this.animated||(this.animated=!0,requestAnimationFrame(function(){return e.animate()}));else{this.animated=!1;for(var t=0;t<4;t++)this.radar1[t].hide(),this.radar2[t].hide(),this.radar3[t].hide(),this.radar4[t].hide()}},e}(BaseWidget),RadialWidget=function(r){"use strict";function e(e,t,i){return r.call(this,e,t,i)||this}return _inheritsLoose(e,r),e.prototype.onWidgetHolderLoad=function(e){r.prototype.onWidgetHolderLoad.call(this,e);var t=e.currentTarget.widget;t._properties.linewidth={tab:"G",value:10,type:"i"},t._properties.rangetype={tab:"G",value:"true",type:"b"},t._properties.min={tab:"G",value:0,type:"f"},t._properties.max={tab:"G",value:100,type:"f"},t._properties.percentbackgroundcolor={tab:"C",value:theme.secondary,type:"c"},t._properties.percentbackgroundopacity={tab:"O",value:.5,type:"f"},t._properties.percentcolor={tab:"C",value:theme.success,type:"c"},t.radius=t.size/3,t.topMargin=t.centreY+t.size/10,t.SVGArcBack=new SVGArc(t.SVGViewBox,t.id+"arcback",t.centreX,t.topMargin,t.radius,t._properties.linewidth),t.SVGArcWidget=new SVGArc(t.SVGViewBox,t.id+"arcwidget",t.centreX,t.topMargin,t.radius,t._properties.linewidth),t.SVGArcSpinner.y=t.topMargin,t.clickableToTop(),t.proprties=t._properties,t.doOnLoad()},e.prototype.drawWidget=function(){if(r.prototype.drawWidget.call(this),null!=this.SVGArcBack){var e=this.data;if("true"!==this._properties.rangetype.value){var t=this._properties.max.value-this._properties.min.value;e=this.data/(t/100)}else(100<e||e<0)&&this.toColor(this.SVGArcWidget,theme.warning);var i=2.4*e;switch(this.SVGArcBack.linewidth=this._properties.linewidth.value,this.SVGArcWidget.linewidth=this._properties.linewidth.value,this.SVGArcBack.color=this._properties.percentbackgroundcolor.value,this.SVGArcBack.opacity=this._properties.percentbackgroundopacity.value,this.SVGArcBack.draw(240,480),this.SVGArcWidget.draw(240,240+i),this._networkStatus){case NET_ONLINE:this.toColor(this.SVGArcWidget,this._properties.percentcolor.value);break;case NET_ERROR:this.toColor(this.SVGArcWidget,theme.danger);break;case NET_RECONNECT:this.toColor(this.SVGArcWidget,theme.info);break;default:this.toColor(this.SVGArcWidget,theme.light)}}},e}(BaseWidget),SmokeWidget=function(s){"use strict";function e(e,t,i){return s.call(this,e,t,i)||this}return _inheritsLoose(e,s),e.prototype.onWidgetHolderLoad=function(e){s.prototype.onWidgetHolderLoad.call(this,e);var t=e.currentTarget.widget;t.radius=t.size/30,t.topMargin=t.centreY+t.size/15,t.animated=!1,t.levelRectWidth=t.size/15,t.levelRectHeight=t.size/100,t.levelLeft=t.width-t.levelRectWidth+t.halfPanding,t.levelTop=(t.height-60*t.levelRectHeight/2)/3,t.level1=[],t.level2=[];for(var i=0;i<10;i++)t.SVGLevelRect1=new SVGRect(t.SVGViewBox,t.id+"levelrect1"+i,t.levelLeft,t.levelTop+i*(2*t.levelRectHeight),t.levelRectWidth,t.levelRectHeight),t.SVGLevelRect2=new SVGRect(t.SVGViewBox,t.id+"levelrect2"+i,t.panding,t.levelTop+i*(2*t.levelRectHeight),t.levelRectWidth,t.levelRectHeight),t.SVGLevelRect1.opacity=t.SVGLevelRect2.opacity=i/30,t.SVGLevelRect1.fill=t.SVGLevelRect2.fill=theme.danger,t.level1.push(t.SVGLevelRect1),t.level2.push(t.SVGLevelRect2);for(i=10;i<20;i++)t.SVGLevelRect1=new SVGRect(t.SVGViewBox,t.id+"levelrect"+i,t.levelLeft,t.levelTop+i*(2*t.levelRectHeight),t.levelRectWidth,t.levelRectHeight),t.SVGLevelRect2=new SVGRect(t.SVGViewBox,t.id+"levelrect2"+i,t.panding,t.levelTop+i*(2*t.levelRectHeight),t.levelRectWidth,t.levelRectHeight),t.SVGLevelRect1.opacity=t.SVGLevelRect2.opacity=i/30,t.SVGLevelRect1.fill=t.SVGLevelRect2.fill=theme.warning,t.level1.push(t.SVGLevelRect1),t.level2.push(t.SVGLevelRect2);for(i=20;i<30;i++)t.SVGLevelRect1=new SVGRect(t.SVGViewBox,t.id+"levelrect"+i,t.levelLeft,t.levelTop+i*(2*t.levelRectHeight),t.levelRectWidth,t.levelRectHeight),t.SVGLevelRect2=new SVGRect(t.SVGViewBox,t.id+"levelrect2"+i,t.panding,t.levelTop+i*(2*t.levelRectHeight),t.levelRectWidth,t.levelRectHeight),t.SVGLevelRect1.opacity=t.SVGLevelRect2.opacity=i/30,t.SVGLevelRect1.fill=t.SVGLevelRect2.fill=theme.success,t.level1.push(t.SVGLevelRect1),t.level2.push(t.SVGLevelRect2);t.levelArc=[];for(i=1;i<5;i++){var r=new SVGArc(t.SVGViewBox,t.id+"arcback1"+i,t.centreX,t.levelTop,i*t.radius,t.size/34);r.index=i,r.fill=theme.danger,t.levelArc.push(r)}t.SVGArcSpinner.y=t.topMargin,t.clickableToTop(),t.proprties=t._properties,t.doOnLoad()},e.prototype.refresh=function(e,t,i){t=getLang(t),s.prototype.refresh.call(this,e,t,i)},e.prototype.drawText=function(){s.prototype.drawText.call(this)},e.prototype.animate=function(){var e=this;if(this.animated){for(var t=0;t<4;t++)this.levelArc[t].radius+=1.5,this.levelArc[t].opacity-=.01,this.levelArc[t].radius>15*this.radius&&(this.levelArc[t].radius=this.radius,this.levelArc[t].opacity=.9),this.levelArc[t].draw(150,210);requestAnimationFrame(function(){return e.animate()})}},e.prototype.drawWidget=function(){var e=this;if(null!=this.level1){s.prototype.drawWidget.call(this);for(var t=0;t<30;t++)this.level1[t].opacity=this.level2[t].opacity=0;var i=.3*this._data;30<i&&(i=30);for(t=29;30-i<t;t--)this.level1[t].opacity=this.level2[t].opacity=1.2-t/30;if(this._networkStatus==NET_ONLINE&&60<this._data)this.animated||(this.animated=!0,requestAnimationFrame(function(){return e.animate()}));else{this.animated=!1;for(t=0;t<4;t++)this.levelArc[t].hide()}}},e}(BaseWidget);